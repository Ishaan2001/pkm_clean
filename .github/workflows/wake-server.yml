name: Send Daily Push Notifications

on:
  schedule:
    # Run at 10:00 AM IST (4:30 AM UTC) every day - direct notification trigger
    - cron: '30 4 * * *'
  workflow_dispatch: # Allow manual triggering for testing

jobs:
  send-notifications:
    runs-on: ubuntu-latest
    
    steps:
    - name: Send daily notifications
      run: |
        # Wake server
        curl -X GET "https://pkm-clean.onrender.com/api/wake-server" --max-time 120 --retry 3 --retry-delay 10
        
        # Trigger notifications
        curl -X POST "https://pkm-clean.onrender.com/api/push/send-daily-notifications" --max-time 60
